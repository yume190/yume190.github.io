<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Source : Adopting Modern Objective-C
Over the years, the Objective-C language has grown and evolved. Although the core concepts and practices remain the same, parts of the language have been through significant changes and improvements. These modernizations improve type safety, memory management, performance, and other aspects of Objective-C, making it easier for you to write correct code. It’s important to adopt these changes in your existing and future code to help it become more consistent, readable, and resilient.
多年來，Objective-C逐漸發展及演變。雖然核心概念和做法保持一致，部分的語言已經通過顯著的變化和改進。這些現代化(modernizations)改進了類型安全，記憶體管理，性能和Objective-C的其他方面，使您更輕鬆地編寫出正確的代碼。採用這些變化到你既有或未來的程式碼是非常重要的，讓它變得更加一致，可讀性，彈性。">
    

    <!--Author-->
    
        <meta name="author" content="Yume">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="IOS Adopting Modern Objective-C"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Yume 練功地"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>IOS Adopting Modern Objective-C - Yume 練功地</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2014/07/19/IOS-2014-07-19-ios-adopting-modern-objective-c/">
                IOS Adopting Modern Objective-C
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2014-07-19</span>
            
            <a href="#disqus_thread" class="comments">Comments</a>
            
                <span class="category">
                    <a href="/categories/IOS/">IOS</a>
                </span>
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <p>Source : <a href="https://developer.apple.com/library/prerelease/ios/releasenotes/ObjectiveC/ModernizationObjC/AdoptingModernObjective-C/AdoptingModernObjective-C.html#//apple_ref/doc/uid/TP40014150" target="_blank" rel="external">Adopting Modern Objective-C</a></p>
<p>Over the years, the Objective-C language has grown and evolved. Although the core concepts and practices remain the same, parts of the language have been through significant changes and improvements. These modernizations improve type safety, memory management, performance, and other aspects of Objective-C, making it easier for you to write correct code. It’s important to adopt these changes in your existing and future code to help it become more consistent, readable, and resilient.</p>
<p>多年來，Objective-C逐漸發展及演變。雖然核心概念和做法保持一致，部分的語言已經通過顯著的變化和改進。這些現代化(modernizations)改進了類型安全，記憶體管理，性能和Objective-C的其他方面，使您更輕鬆地編寫出正確的代碼。採用這些變化到你既有或未來的程式碼是非常重要的，讓它變得更加一致，可讀性，彈性。</p>
 <a id="more"></a>
<h2 id="Instancetype"><a href="#Instancetype" class="headerlink" title="Instancetype"></a>Instancetype</h2><p>Use the instancetype keyword as the return type of methods that return an instance of the class they are called on (or a subclass of that class). These methods include alloc, init, and class factory methods.</p>
<figure class="highlight objc"><figcaption><span>Instancetype</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyObject</span></span></span><br><span class="line"></span><br><span class="line">- (instancetype)myFactoryMethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>個人理解是<code>alloc</code>, <code>init</code>, and <code>class factory methods</code> 都從回傳 <code>id</code> 改成回傳 <code>instancetype</code></p>
<p>To make sure <code>instancetype</code> factory methods have the right subclassing behavior, be sure to use <code>[self class]</code> when allocating the class rather than referring directly to the class name.</p>
<p>為了確保<code>instancetype</code>工廠方法有正確的子類的行為，一定要使用<code>[self class]</code> when allocating the class rather than referring directly to the class name</p>
<p><code>+ (instancetype)factoryMethodA { return [[[self class] alloc] init]; }</code></p>
<h2 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h2><p>Using properties instead of instance variables in as many places as possible provides many benefits:</p>
<ul>
<li>Autosynthesized getters and setters. When you declare a property, by default getter and setter methods are created for you.</li>
<li>Better declaration of intent of a set of methods. Because of accessor method naming conventions, it’s clear exactly what the getter and setter are doing.</li>
<li>Property keywords that express  information about behavior. Properties provide the potential for declaration of attributes like assign (vs copy), weak, atomic (vs nonatomic), and so on.</li>
</ul>
<p>使用<code>property</code>而不是實體變數，在許多方面可以提供很多好處</p>
<ol>
<li>自動合成<code>getter &amp; setter</code></li>
<li>更明確的方法意圖：因為存取方法已有它的命名慣例，因此它可以很明確的說明<code>getter &amp; setter</code> 在幹嘛 ＸＤ</li>
<li><code>property</code>的關鍵字表達了額外的行為資訊：如<code>copy</code>,<code>assign</code>,<code>weak</code>等等</li>
</ol>
<p>The naming convention for Boolean properties is to declare them with a named getter starting with the word “is”:</p>
<p>Boolean properties的命名慣例是在<code>getter</code>前加入<code>&quot;is&quot;</code></p>
<figure class="highlight objc"><figcaption><span>Boolean properties</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, getter=isBlue) <span class="built_in">BOOL</span> blue;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>As a result, all of the following work:</p>
<figure class="highlight objc"><figcaption><span>Boolean properties getter</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (color.blue) &#123; &#125;</span><br><span class="line"><span class="keyword">if</span> (color.isBlue) &#123; &#125;</span><br><span class="line"><span class="keyword">if</span> ([color isBlue]) &#123; &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>When deciding what can be a property, keep in mind that the following are not properties:</p>
<ul>
<li>init method</li>
<li>copy method, mutableCopy method</li>
<li>A class factory method</li>
<li>A method that initiates an action and returns a BOOL result</li>
<li>A method that explicitly changes internal state as a side effect of a getter</li>
</ul>
<p>請注意下列幾項並不是property:</p>
<ol>
<li><code>init</code> 方法</li>
<li><code>copy</code>, <code>mutableCopy</code> 方法</li>
<li>類別工廠方法</li>
<li>發起行動後並回傳<code>BOOL</code>結果的方法</li>
<li>明確地改變內部狀態（或者說是具有副作用）的getter</li>
</ol>
<p>Additionally, consider the following set of rules when identifying potential properties in your code:</p>
<ul>
<li>A read/write property has two accessor methods. The setter takes one argument and returns nothing, and the getter takes no arguments and returns one value. If you convert this set of methods into a property, tag it with the readwrite keyword.</li>
<li>A read-only property has a single accessor method, the getter, which takes no arguments and returns one value. If you convert this method into a property, tag it with the readonly keyword.</li>
<li>The getter should be idempotent (if a getter is called twice, the second call results in the same result as the first). However, it is acceptable for a getter to compute the result each time it’s called.</li>
</ul>
<ol>
<li>read/write property有兩個存取方法。setter接收一個參數並且不回傳值，getter不接收參數且回傳一個值，假使你轉換這組方法到property的話，把它標上<code>readwrite</code>關鍵字。</li>
<li>…</li>
<li><code>getter</code>應<code>idempotent</code>(當<code>getter</code>被呼叫兩次<strong>這裡指連續呼叫</strong>，兩次的結果應該是要相同的)。然而，<code>getter</code>被呼叫的時候才去計算他的結果也是可以被接受的。</li>
</ol>
<h2 id="Enumeration-Macros"><a href="#Enumeration-Macros" class="headerlink" title="Enumeration Macros"></a>Enumeration Macros</h2><p>The NS_ENUM and NS_OPTIONS macros provide a concise, simple way of defining enumerations and options in C-based languages. These macros improve code completion in Xcode and explicitly specify the type and size of your enumerations and options. Additionally, this syntax declares enums in a way that is evaluated correctly by older compilers, and by newer ones that can interpret the underlying type information.</p>
<figure class="highlight objc"><figcaption><span>Old Enum</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">enum</span> &#123;</span><br><span class="line">        <span class="built_in">UITableViewCellStyleDefault</span>,</span><br><span class="line">        <span class="built_in">UITableViewCellStyleValue1</span>,</span><br><span class="line">        <span class="built_in">UITableViewCellStyleValue2</span>,</span><br><span class="line">        <span class="built_in">UITableViewCellStyleSubtitle</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NSInteger</span> <span class="built_in">UITableViewCellStyle</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><figcaption><span>New Enum</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">UITableViewCellStyle</span>) &#123;</span><br><span class="line">        <span class="built_in">UITableViewCellStyleDefault</span>,</span><br><span class="line">        <span class="built_in">UITableViewCellStyleValue1</span>,</span><br><span class="line">        <span class="built_in">UITableViewCellStyleValue2</span>,</span><br><span class="line">        <span class="built_in">UITableViewCellStyleSubtitle</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><figcaption><span>Old Enum Option</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">enum</span> &#123;</span><br><span class="line">        <span class="built_in">UIViewAutoresizingNone</span>                 = <span class="number">0</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleLeftMargin</span>   = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleWidth</span>        = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleRightMargin</span>  = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleTopMargin</span>    = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleHeight</span>       = <span class="number">1</span> &lt;&lt; <span class="number">4</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleBottomMargin</span> = <span class="number">1</span> &lt;&lt; <span class="number">5</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NSUInteger</span> <span class="built_in">UIViewAutoresizing</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><figcaption><span>New Enum Option</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_OPTIONS</span>(<span class="built_in">NSUInteger</span>, <span class="built_in">UIViewAutoresizing</span>) &#123;</span><br><span class="line">        <span class="built_in">UIViewAutoresizingNone</span>                 = <span class="number">0</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleLeftMargin</span>   = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleWidth</span>        = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleRightMargin</span>  = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleTopMargin</span>    = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleHeight</span>       = <span class="number">1</span> &lt;&lt; <span class="number">4</span>,</span><br><span class="line">        <span class="built_in">UIViewAutoresizingFlexibleBottomMargin</span> = <span class="number">1</span> &lt;&lt; <span class="number">5</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Object-Initialization"><a href="#Object-Initialization" class="headerlink" title="Object Initialization"></a>Object Initialization</h2><p>In Objective-C, object initialization is based on the notion of a designated initializer, an initializer method that is responsible for calling one of its superclass’s initializers and then initializing its own instance variables. Initializers that are not designated initializers are known as convenience initializers. Convenience initializers typically delegate to another initializer—eventually terminating the chain at a designated initializer—rather than performing initialization themselves.</p>
<p>The designated initializer pattern helps ensure that inherited initializers properly initialize all instance variables. A subclass that needs to perform nontrivial initialization should override all of its superclass’s designated initializers, but it does not need to override the convenience initializers. For more information about initializers, see Object Initialization.</p>
<p>To clarify the distinction between designated and designated initializers clear, you can add the NS_DESIGNATED_INITIALIZER macro to any method in the init family, denoting it a designated initializer. Using this macro introduces a few restrictions:</p>
<ul>
<li>The implementation of a designated initializer must chain to a superclass init method (with [super init…]) that is a designated initializer for the superclass.</li>
<li>The implementation of a convenience initializer (an initializer not marked as a designated initializer within a class that has at least one initializer marked as a designated initializer) must delegate to another initializer (with [self init…]).</li>
<li>If a class provides one or more designated initializers, it must implement all of the designated initializers of its superclass.</li>
</ul>
<p>If any of these restrictions are violated, you receive warnings from the compiler.</p>
<p>If you use the NS_DESIGNATED_INITIALIZER macro in your class, you need to mark all of your designated initializers with this macro. All other initializers will be considered to be convenience initializers.</p>
<h2 id="Automatic-Reference-Counting-ARC"><a href="#Automatic-Reference-Counting-ARC" class="headerlink" title="Automatic Reference Counting (ARC)"></a>Automatic Reference Counting (ARC)</h2><p>Automatic Reference Counting (ARC) is a compiler feature that provides automatic memory management of Objective-C objects. Instead of your having to remember when to use retain, release, and autorelease, ARC evaluates the lifetime requirements of your objects and automatically inserts appropriate memory management calls for you at compile time. The compiler also generates appropriate dealloc methods for you.</p>
<p>ARC</p>

    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/IOS/">#IOS</a> <a href="/tags/Apple-Doc/">#Apple_Doc</a>
        </div>
    

    <!-- Comments -->
    

</div>
        </section>

    </div>
</div>

</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    工作時的筆記
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2017/03/07/WWDC-2016-416/">WWDC 2016 416</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2017/03/03/建立純-swift-module/">建立純 swift module</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2017/03/02/Android-call-Swift-舊版/">Android call Swift 舊版</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2017/02/22/LLVM-Build/">LLVM Build</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/IOS/Localize/">Localize</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/lua/">lua</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/Android/Auto-Restart/">Auto-Restart</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/Android/Custom-Permission/">Custom_Permission</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/yume190">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.facebook.com/yume190">
                            <span class="footer-icon-container">
                                <i class="fa fa-facebook"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:yume190@gmail.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo <a href="http://www.codeblocq.com/">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>